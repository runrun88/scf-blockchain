/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: jetty/9.4.44.v20210927
 * Generated at: 2025-03-09 10:43:07 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class contractDetail_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = null;
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\n");
      out.write("    <!DOCTYPE html>\n");
      out.write("    <html lang=\"en\">\n");
      out.write("\n");
      out.write("    <head>\n");
      out.write("        <meta charset=\"UTF-8\">\n");
      out.write("        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n");
      out.write("        <title>Contract Details - Supply Chain Finance</title>\n");
      out.write("        <!-- Bootstrap CSS for responsive layout and styling -->\n");
      out.write("        <link href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" rel=\"stylesheet\">\n");
      out.write("        <style>\n");
      out.write("            /* Custom styles */\n");
      out.write("            body {\n");
      out.write("                font-family: Arial, sans-serif;\n");
      out.write("                background-color: #f4f7fa;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .container {\n");
      out.write("                margin-top: 30px;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .menu {\n");
      out.write("                margin-bottom: 30px;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .menu a {\n");
      out.write("                color: #fff;\n");
      out.write("                font-size: 18px;\n");
      out.write("                margin: 0 15px;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .menu a:hover {\n");
      out.write("                text-decoration: underline;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .header {\n");
      out.write("                background-color: #007bff;\n");
      out.write("                padding: 15px;\n");
      out.write("                color: white;\n");
      out.write("                text-align: center;\n");
      out.write("                font-size: 24px;\n");
      out.write("                border-radius: 10px;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .footer {\n");
      out.write("                text-align: center;\n");
      out.write("                margin-top: 50px;\n");
      out.write("                font-size: 14px;\n");
      out.write("                color: #aaa;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .detail-panel {\n");
      out.write("                background-color: #ffffff;\n");
      out.write("                padding: 20px;\n");
      out.write("                border-radius: 10px;\n");
      out.write("                box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);\n");
      out.write("                margin-bottom: 30px;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .form-section {\n");
      out.write("                margin-bottom: 30px;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            /* Updated dropdown menu styling */\n");
      out.write("            .dropdown-menu {\n");
      out.write("                background-color: #f8f9fa;\n");
      out.write("                border-radius: 5px;\n");
      out.write("                margin-top: 10px;\n");
      out.write("                box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);\n");
      out.write("                z-index: 1021;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .dropdown-item {\n");
      out.write("                color: #333333 !important;\n");
      out.write("                font-weight: 500;\n");
      out.write("                padding: 0.5rem 1.5rem;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .dropdown-item:hover {\n");
      out.write("                background-color: #007bff;\n");
      out.write("                color: white !important;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            /* Make the dropdown visible */\n");
      out.write("            .dropdown-toggle {\n");
      out.write("                cursor: pointer;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            .dropdown-toggle::after {\n");
      out.write("                display: inline-block;\n");
      out.write("                margin-left: 0.255em;\n");
      out.write("                vertical-align: 0.255em;\n");
      out.write("                content: \"\";\n");
      out.write("                border-top: 0.3em solid;\n");
      out.write("                border-right: 0.3em solid transparent;\n");
      out.write("                border-bottom: 0;\n");
      out.write("                border-left: 0.3em solid transparent;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            /* Fix inline display */\n");
      out.write("            .dropdown.d-inline-block {\n");
      out.write("                vertical-align: middle;\n");
      out.write("            }\n");
      out.write("        </style>\n");
      out.write("    </head>\n");
      out.write("\n");
      out.write("    <body>\n");
      out.write("\n");
      out.write("        <!-- Header and Navigation Menu -->\n");
      out.write("        <div class=\"header\">\n");
      out.write("            <h1>Supply Chain Finance Platform</h1>\n");
      out.write("            <div class=\"menu\">\n");
      out.write("                <a href=\"index.jsp\">Home</a>\n");
      out.write("                <a href=\"#user-management\">User</a>\n");
      out.write("\n");
      out.write("                <!-- Enterprise dropdown menu -->\n");
      out.write("                <div class=\"dropdown d-inline-block\">\n");
      out.write("                    <a class=\"dropdown-toggle\" href=\"#\" role=\"button\" id=\"enterpriseDropdown\" data-toggle=\"dropdown\"\n");
      out.write("                        aria-haspopup=\"true\" aria-expanded=\"false\">\n");
      out.write("                        Enterprise\n");
      out.write("                    </a>\n");
      out.write("                    <div class=\"dropdown-menu\" aria-labelledby=\"enterpriseDropdown\">\n");
      out.write("                        <a class=\"dropdown-item\" href=\"enterprise.jsp\">Search Enterprises</a>\n");
      out.write("                        <a class=\"dropdown-item\" href=\"enterpriseDetail.jsp?mode=add\">Add New Enterprise</a>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("                <!-- Contract dropdown menu -->\n");
      out.write("                <div class=\"dropdown d-inline-block\">\n");
      out.write("                    <a class=\"dropdown-toggle\" href=\"#\" role=\"button\" id=\"contractDropdown\" data-toggle=\"dropdown\"\n");
      out.write("                        aria-haspopup=\"true\" aria-expanded=\"false\">\n");
      out.write("                        Contract\n");
      out.write("                    </a>\n");
      out.write("                    <div class=\"dropdown-menu\" aria-labelledby=\"contractDropdown\">\n");
      out.write("                        <a class=\"dropdown-item\" href=\"contract.jsp\">Search Contracts</a>\n");
      out.write("                        <a class=\"dropdown-item\" href=\"contractDetail.jsp?mode=add\">Add New Contract</a>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("                <!-- Invoice dropdown menu -->\n");
      out.write("                <div class=\"dropdown d-inline-block\">\n");
      out.write("                    <a class=\"dropdown-toggle\" href=\"#\" role=\"button\" id=\"invoiceDropdown\" data-toggle=\"dropdown\"\n");
      out.write("                        aria-haspopup=\"true\" aria-expanded=\"false\">\n");
      out.write("                        Invoice\n");
      out.write("                    </a>\n");
      out.write("                    <div class=\"dropdown-menu\" aria-labelledby=\"invoiceDropdown\">\n");
      out.write("                        <a class=\"dropdown-item\" href=\"invoice.jsp\">Search Invoices</a>\n");
      out.write("                        <a class=\"dropdown-item\" href=\"invoiceDetail.jsp?mode=add\">Add New Invoice</a>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("\n");
      out.write("        <div class=\"container\">\n");
      out.write("            <!-- Contract Details Panel -->\n");
      out.write("            <div class=\"row\">\n");
      out.write("                <div class=\"col-12\">\n");
      out.write("                    <div class=\"detail-panel\">\n");
      out.write("                        <h3 class=\"mb-4\" id=\"panelTitle\">Add New Contract</h3>\n");
      out.write("\n");
      out.write("                        <!-- Form for adding or editing a contract -->\n");
      out.write("                        <form id=\"contractForm\">\n");
      out.write("                            <div class=\"form-section\">\n");
      out.write("                                <h4>Basic Information</h4>\n");
      out.write("                                <div class=\"form-row\">\n");
      out.write("                                    <div class=\"form-group col-md-6\">\n");
      out.write("                                        <label for=\"contractId\">Contract ID</label>\n");
      out.write("                                        <input type=\"text\" class=\"form-control\" id=\"contractId\"\n");
      out.write("                                            placeholder=\"Auto-generated\" readonly>\n");
      out.write("                                    </div>\n");
      out.write("                                    <div class=\"form-group col-md-6\">\n");
      out.write("                                        <label for=\"contractName\">Contract Name</label>\n");
      out.write("                                        <input type=\"text\" class=\"form-control\" id=\"contractName\"\n");
      out.write("                                            placeholder=\"Enter Contract Name\">\n");
      out.write("                                    </div>\n");
      out.write("                                </div>\n");
      out.write("                                <div class=\"form-row\">\n");
      out.write("                                    <div class=\"form-group col-md-6\">\n");
      out.write("                                        <label for=\"contractType\">Contract Type</label>\n");
      out.write("                                        <select class=\"form-control\" id=\"contractType\">\n");
      out.write("                                            <option value=\"Purchase\">Purchase Contract</option>\n");
      out.write("                                            <option value=\"Sales\">Sales Contract</option>\n");
      out.write("                                            <option value=\"Service\">Service Contract</option>\n");
      out.write("                                        </select>\n");
      out.write("                                    </div>\n");
      out.write("                                    <div class=\"form-group col-md-6\">\n");
      out.write("                                        <label for=\"contractStatus\">Status</label>\n");
      out.write("                                        <select class=\"form-control\" id=\"contractStatus\">\n");
      out.write("                                            <option value=\"Draft\">Draft</option>\n");
      out.write("                                            <option value=\"Pending\">Pending</option>\n");
      out.write("                                            <option value=\"Active\">Active</option>\n");
      out.write("                                        </select>\n");
      out.write("                                    </div>\n");
      out.write("                                </div>\n");
      out.write("                            </div>\n");
      out.write("\n");
      out.write("                            <div class=\"form-section\">\n");
      out.write("                                <h4>Enterprise Information</h4>\n");
      out.write("                                <div class=\"form-row\">\n");
      out.write("                                    <div class=\"form-group col-md-6\">\n");
      out.write("                                        <label for=\"fromEnterpriseId\">From Enterprise</label>\n");
      out.write("                                        <div class=\"input-group\">\n");
      out.write("                                            <input type=\"text\" class=\"form-control\" id=\"fromEnterpriseId\"\n");
      out.write("                                                placeholder=\"Enterprise ID\" readonly>\n");
      out.write("                                            <input type=\"text\" class=\"form-control\" id=\"fromEnterpriseName\"\n");
      out.write("                                                placeholder=\"Enterprise Name\" readonly>\n");
      out.write("                                            <div class=\"input-group-append\">\n");
      out.write("                                                <button class=\"btn btn-outline-secondary\" type=\"button\"\n");
      out.write("                                                    onclick=\"selectFromEnterprise()\">Select</button>\n");
      out.write("                                            </div>\n");
      out.write("                                        </div>\n");
      out.write("                                    </div>\n");
      out.write("                                    <div class=\"form-group col-md-6\">\n");
      out.write("                                        <label for=\"toEnterpriseId\">To Enterprise</label>\n");
      out.write("                                        <div class=\"input-group\">\n");
      out.write("                                            <input type=\"text\" class=\"form-control\" id=\"toEnterpriseId\"\n");
      out.write("                                                placeholder=\"Enterprise ID\" readonly>\n");
      out.write("                                            <input type=\"text\" class=\"form-control\" id=\"toEnterpriseName\"\n");
      out.write("                                                placeholder=\"Enterprise Name\" readonly>\n");
      out.write("                                            <div class=\"input-group-append\">\n");
      out.write("                                                <button class=\"btn btn-outline-secondary\" type=\"button\"\n");
      out.write("                                                    onclick=\"selectToEnterprise()\">Select</button>\n");
      out.write("                                            </div>\n");
      out.write("                                        </div>\n");
      out.write("                                    </div>\n");
      out.write("                                </div>\n");
      out.write("                            </div>\n");
      out.write("\n");
      out.write("                            <div class=\"form-section\">\n");
      out.write("                                <h4>Financial Information</h4>\n");
      out.write("                                <div class=\"form-row\">\n");
      out.write("                                    <div class=\"form-group col-md-4\">\n");
      out.write("                                        <label for=\"amount\">Total Amount</label>\n");
      out.write("                                        <div class=\"input-group\">\n");
      out.write("                                            <div class=\"input-group-prepend\">\n");
      out.write("                                                <span class=\"input-group-text\">$</span>\n");
      out.write("                                            </div>\n");
      out.write("                                            <input type=\"number\" class=\"form-control\" id=\"amount\" placeholder=\"0.00\"\n");
      out.write("                                                step=\"0.01\">\n");
      out.write("                                        </div>\n");
      out.write("                                    </div>\n");
      out.write("                                    <div class=\"form-group col-md-4\">\n");
      out.write("                                        <label for=\"signDate\">Sign Date</label>\n");
      out.write("                                        <input type=\"date\" class=\"form-control\" id=\"signDate\">\n");
      out.write("                                    </div>\n");
      out.write("                                    <div class=\"form-group col-md-4\">\n");
      out.write("                                        <label for=\"effectiveDate\">Effective Date</label>\n");
      out.write("                                        <input type=\"date\" class=\"form-control\" id=\"effectiveDate\">\n");
      out.write("                                    </div>\n");
      out.write("                                </div>\n");
      out.write("                                <div class=\"form-row\">\n");
      out.write("                                    <div class=\"form-group col-md-4\">\n");
      out.write("                                        <label for=\"expiryDate\">Expiry Date</label>\n");
      out.write("                                        <input type=\"date\" class=\"form-control\" id=\"expiryDate\">\n");
      out.write("                                    </div>\n");
      out.write("                                    <div class=\"form-group col-md-8\">\n");
      out.write("                                        <label for=\"paymentTerms\">Payment Terms</label>\n");
      out.write("                                        <input type=\"text\" class=\"form-control\" id=\"paymentTerms\"\n");
      out.write("                                            placeholder=\"e.g., Net 30 days\">\n");
      out.write("                                    </div>\n");
      out.write("                                </div>\n");
      out.write("                            </div>\n");
      out.write("\n");
      out.write("                            <div class=\"form-section\">\n");
      out.write("                                <h4>Additional Information</h4>\n");
      out.write("                                <div class=\"form-group\">\n");
      out.write("                                    <label for=\"description\">Description</label>\n");
      out.write("                                    <textarea class=\"form-control\" id=\"description\" rows=\"3\"\n");
      out.write("                                        placeholder=\"Enter contract description\"></textarea>\n");
      out.write("                                </div>\n");
      out.write("                                <div class=\"form-group\">\n");
      out.write("                                    <label for=\"remarks\">Remarks</label>\n");
      out.write("                                    <textarea class=\"form-control\" id=\"remarks\" rows=\"2\"\n");
      out.write("                                        placeholder=\"Any additional notes\"></textarea>\n");
      out.write("                                </div>\n");
      out.write("                            </div>\n");
      out.write("\n");
      out.write("                            <div class=\"form-row mt-4\">\n");
      out.write("                                <div class=\"col-md-6 mb-2\">\n");
      out.write("                                    <button type=\"button\" class=\"btn btn-primary btn-block\"\n");
      out.write("                                        onclick=\"saveContract()\">Save Contract</button>\n");
      out.write("                                </div>\n");
      out.write("                                <div class=\"col-md-6 mb-2\">\n");
      out.write("                                    <button type=\"button\" class=\"btn btn-secondary btn-block\"\n");
      out.write("                                        onclick=\"goBack()\">Cancel</button>\n");
      out.write("                                </div>\n");
      out.write("                            </div>\n");
      out.write("                        </form>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("\n");
      out.write("        <!-- Footer -->\n");
      out.write("        <div class=\"footer\">\n");
      out.write("            <p>&copy; 2025 Supply Chain Finance Platform | All rights reserved.</p>\n");
      out.write("        </div>\n");
      out.write("\n");
      out.write("        <!-- Bootstrap and jQuery JS -->\n");
      out.write("        <script src=\"https://code.jquery.com/jquery-3.5.1.min.js\"></script>\n");
      out.write("        <script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js\"></script>\n");
      out.write("        <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js\"></script>\n");
      out.write("\n");
      out.write("        <script>\n");
      out.write("            // Variable to track the current mode (add or view/edit)\n");
      out.write("            let isAddMode = true;\n");
      out.write("\n");
      out.write("            // Function to initialize the page based on parameters\n");
      out.write("            function initPage() {\n");
      out.write("                const urlParams = new URLSearchParams(window.location.search);\n");
      out.write("                const id = urlParams.get('id');\n");
      out.write("                const mode = urlParams.get('mode');\n");
      out.write("\n");
      out.write("                if (mode === 'add') {\n");
      out.write("                    isAddMode = true;\n");
      out.write("                    document.getElementById('panelTitle').innerText = 'Add New Contract';\n");
      out.write("                    // Set today's date as the default sign date\n");
      out.write("                    document.getElementById('signDate').valueAsDate = new Date();\n");
      out.write("                } else if (id) {\n");
      out.write("                    isAddMode = false;\n");
      out.write("                    document.getElementById('panelTitle').innerText = 'Contract Details';\n");
      out.write("                    loadContractDetails(id);\n");
      out.write("                } else {\n");
      out.write("                    alert('Invalid parameters. Redirecting to contract search.');\n");
      out.write("                    window.location.href = 'contract.jsp';\n");
      out.write("                }\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to load contract details (for edit mode)\n");
      out.write("            function loadContractDetails(id) {\n");
      out.write("                // This would be an AJAX call to get contract details from the server\n");
      out.write("                // For now, just show an alert\n");
      out.write("                alert('Loading contract with ID: ' + id);\n");
      out.write("\n");
      out.write("                // Simulate loading data after a delay\n");
      out.write("                setTimeout(() => {\n");
      out.write("                    document.getElementById('contractId').value = id;\n");
      out.write("                    document.getElementById('contractName').value = 'Sample Contract ' + id;\n");
      out.write("                    // Set other fields...\n");
      out.write("                }, 500);\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Global variable to store current target fields\n");
      out.write("            let currentTargetFields = {\n");
      out.write("                idField: '',\n");
      out.write("                nameField: ''\n");
      out.write("            };\n");
      out.write("\n");
      out.write("            // Function to select from enterprise\n");
      out.write("            function selectFromEnterprise() {\n");
      out.write("                // Set the target fields for the selection\n");
      out.write("                currentTargetFields = {\n");
      out.write("                    idField: 'fromEnterpriseId',\n");
      out.write("                    nameField: 'fromEnterpriseName'\n");
      out.write("                };\n");
      out.write("\n");
      out.write("                // Clear previous search results\n");
      out.write("                document.getElementById('searchEnterpriseId').value = '';\n");
      out.write("                document.getElementById('searchEnterpriseName').value = '';\n");
      out.write("                document.getElementById('enterpriseResultBody').innerHTML = '';\n");
      out.write("                document.getElementById('enterpriseSearchMessage').innerText = 'Enter search criteria and click Search';\n");
      out.write("\n");
      out.write("                // Open the enterprise selection modal\n");
      out.write("                $('#enterpriseSearchModal').modal('show');\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to select to enterprise\n");
      out.write("            function selectToEnterprise() {\n");
      out.write("                // Set the target fields for the selection\n");
      out.write("                currentTargetFields = {\n");
      out.write("                    idField: 'toEnterpriseId',\n");
      out.write("                    nameField: 'toEnterpriseName'\n");
      out.write("                };\n");
      out.write("\n");
      out.write("                // Clear previous search results\n");
      out.write("                document.getElementById('searchEnterpriseId').value = '';\n");
      out.write("                document.getElementById('searchEnterpriseName').value = '';\n");
      out.write("                document.getElementById('enterpriseResultBody').innerHTML = '';\n");
      out.write("                document.getElementById('enterpriseSearchMessage').innerText = 'Enter search criteria and click Search';\n");
      out.write("\n");
      out.write("                // Open the enterprise selection modal\n");
      out.write("                $('#enterpriseSearchModal').modal('show');\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to search for enterprises\n");
      out.write("            function searchEnterprises() {\n");
      out.write("                const enterpriseId = document.getElementById('searchEnterpriseId').value;\n");
      out.write("                const enterpriseName = document.getElementById('searchEnterpriseName').value;\n");
      out.write("\n");
      out.write("                if (!enterpriseId && !enterpriseName) {\n");
      out.write("                    document.getElementById('enterpriseSearchMessage').innerHTML =\n");
      out.write("                        '<div class=\"alert alert-warning\">Please enter at least one search criteria</div>';\n");
      out.write("                    return;\n");
      out.write("                }\n");
      out.write("\n");
      out.write("                document.getElementById('enterpriseSearchMessage').innerHTML =\n");
      out.write("                    '<div class=\"spinner-border text-primary\" role=\"status\"><span class=\"sr-only\">Loading...</span></div>';\n");
      out.write("\n");
      out.write("                // 创建搜索参数，与enterprise.jsp中的方式保持一致\n");
      out.write("                const searchParams = new URLSearchParams();\n");
      out.write("                if (enterpriseId) searchParams.append('id', enterpriseId);\n");
      out.write("                if (enterpriseName) searchParams.append('name', enterpriseName);\n");
      out.write("                // 添加一个空的type参数，保持一致性\n");
      out.write("                searchParams.append('type', '');\n");
      out.write("\n");
      out.write("                console.log('Search URL: searchEnterprises?' + searchParams.toString());\n");
      out.write("\n");
      out.write("                // 使用与enterprise.jsp相同的URL和参数调用方式\n");
      out.write("                $.ajax({\n");
      out.write("                    url: 'searchEnterprises?' + searchParams.toString(),  // 使用正确的Servlet名称\n");
      out.write("                    type: 'GET',\n");
      out.write("                    dataType: 'json',\n");
      out.write("                    success: function (data) {\n");
      out.write("                        console.log(\"Enterprise search result:\", data);\n");
      out.write("                        displayEnterpriseSearchResults(data);\n");
      out.write("                    },\n");
      out.write("                    error: function (xhr, status, error) {\n");
      out.write("                        console.error(\"Error searching enterprises:\", error);\n");
      out.write("                        console.error(\"Response status:\", xhr.status);\n");
      out.write("                        console.error(\"Response text:\", xhr.responseText);\n");
      out.write("\n");
      out.write("                        document.getElementById('enterpriseSearchMessage').innerHTML =\n");
      out.write("                            '<div class=\"alert alert-danger\">Error searching enterprises: ' + error + '</div>';\n");
      out.write("                    }\n");
      out.write("                });\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to display enterprise search results - 修改为与 enterprise.jsp 一致\n");
      out.write("            function displayEnterpriseSearchResults(enterprises) {\n");
      out.write("                const tableBody = document.getElementById('enterpriseResultBody');\n");
      out.write("                tableBody.innerHTML = '';\n");
      out.write("\n");
      out.write("                console.log(\"Displaying enterprises:\", enterprises);\n");
      out.write("\n");
      out.write("                if (enterprises && enterprises.length > 0) {\n");
      out.write("                    enterprises.forEach(function (enterprise) {\n");
      out.write("                        // 创建表格行\n");
      out.write("                        const row = document.createElement('tr');\n");
      out.write("                        row.style.cursor = 'pointer';\n");
      out.write("\n");
      out.write("                        // 存储企业 ID 和名称用于选择\n");
      out.write("                        row.setAttribute('data-enterprise-id', enterprise.enterpriseID);\n");
      out.write("                        row.setAttribute('data-enterprise-name', enterprise.enterpriseName);\n");
      out.write("\n");
      out.write("                        // 企业 ID 列\n");
      out.write("                        const idCell = document.createElement('td');\n");
      out.write("                        idCell.textContent = enterprise.enterpriseID;\n");
      out.write("                        row.appendChild(idCell);\n");
      out.write("\n");
      out.write("                        // 名称列\n");
      out.write("                        const nameCell = document.createElement('td');\n");
      out.write("                        nameCell.textContent = enterprise.enterpriseName;\n");
      out.write("                        row.appendChild(nameCell);\n");
      out.write("\n");
      out.write("                        // 类型列\n");
      out.write("                        const typeCell = document.createElement('td');\n");
      out.write("                        typeCell.textContent = enterprise.role || '';\n");
      out.write("                        row.appendChild(typeCell);\n");
      out.write("\n");
      out.write("                              // 电话列 - 改为显示电话而非层级\n");
      out.write("            const phoneCell = document.createElement('td');\n");
      out.write("            phoneCell.textContent = enterprise.telephone || '';\n");
      out.write("            row.appendChild(phoneCell);\n");
      out.write("\n");
      out.write("                        // 地址列\n");
      out.write("                        const addressCell = document.createElement('td');\n");
      out.write("                        addressCell.textContent = enterprise.address || '';\n");
      out.write("                        row.appendChild(addressCell);\n");
      out.write("\n");
      out.write("                        // 添加行到表格\n");
      out.write("                        tableBody.appendChild(row);\n");
      out.write("                    });\n");
      out.write("\n");
      out.write("                    document.getElementById('enterpriseSearchMessage').innerHTML =\n");
      out.write("                        `<div class=\"alert alert-success\">");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${enterprises.length}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write(" enterprises found. Double-click a row to select.</div>`;\n");
      out.write("                } else {\n");
      out.write("                    document.getElementById('enterpriseSearchMessage').innerHTML =\n");
      out.write("                        '<div class=\"alert alert-info\">No enterprises found matching your criteria</div>';\n");
      out.write("                }\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to select an enterprise from search results\n");
      out.write("            function selectEnterpriseFromRow(enterpriseId, enterpriseName) {\n");
      out.write("                if (currentTargetFields.idField && currentTargetFields.nameField) {\n");
      out.write("                    document.getElementById(currentTargetFields.idField).value = enterpriseId;\n");
      out.write("                    document.getElementById(currentTargetFields.nameField).value = enterpriseName;\n");
      out.write("                    $('#enterpriseSearchModal').modal('hide');\n");
      out.write("                }\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to save the contract\n");
      out.write("            function saveContract() {\n");
      out.write("                // Validate form fields\n");
      out.write("                if (!validateForm()) {\n");
      out.write("                    return;\n");
      out.write("                }\n");
      out.write("\n");
      out.write("                // This would be an AJAX call to save the contract to the server\n");
      out.write("                alert('Contract saved successfully');\n");
      out.write("\n");
      out.write("                // Redirect to contract search page\n");
      out.write("                window.location.href = 'contract.jsp';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to validate the form\n");
      out.write("            function validateForm() {\n");
      out.write("                // Add your validation logic here\n");
      out.write("                const contractName = document.getElementById('contractName').value;\n");
      out.write("                if (!contractName) {\n");
      out.write("                    alert('Please enter a contract name');\n");
      out.write("                    return false;\n");
      out.write("                }\n");
      out.write("\n");
      out.write("                return true;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Function to go back to the previous page\n");
      out.write("            function goBack() {\n");
      out.write("                window.location.href = 'contract.jsp';\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            // Initialize when document is ready\n");
      out.write("            $(document).ready(function () {\n");
      out.write("                // Initialize page\n");
      out.write("                initPage();\n");
      out.write("\n");
      out.write("                // Initialize dropdown menu\n");
      out.write("                $('.dropdown-toggle').dropdown();\n");
      out.write("\n");
      out.write("                // Add event listener to make dropdown work on hover too\n");
      out.write("                $('.dropdown').hover(\n");
      out.write("                    function () {\n");
      out.write("                        $(this).find('.dropdown-menu').stop(true, true).delay(100).fadeIn(100);\n");
      out.write("                    },\n");
      out.write("                    function () {\n");
      out.write("                        $(this).find('.dropdown-menu').stop(true, true).delay(100).fadeOut(100);\n");
      out.write("                    }\n");
      out.write("                );\n");
      out.write("\n");
      out.write("                // Add event listener for enterprise search table rows\n");
      out.write("                $(document).on('click', '#enterpriseResultTable tbody tr', function () {\n");
      out.write("                    // Highlight the selected row\n");
      out.write("                    $(this).addClass('table-primary').siblings().removeClass('table-primary');\n");
      out.write("                });\n");
      out.write("\n");
      out.write("                // Add double-click event for quick selection\n");
      out.write("                $(document).on('dblclick', '#enterpriseResultTable tbody tr', function () {\n");
      out.write("                    const enterpriseId = $(this).attr('data-enterprise-id');\n");
      out.write("                    const enterpriseName = $(this).attr('data-enterprise-name');\n");
      out.write("                    selectEnterpriseFromRow(enterpriseId, enterpriseName);\n");
      out.write("                });\n");
      out.write("\n");
      out.write("            });\n");
      out.write("            // Function to load contract details (for edit mode)\n");
      out.write("            function loadContractDetails(id) {\n");
      out.write("                // Make AJAX call to get contract details\n");
      out.write("                $.ajax({\n");
      out.write("                    url: \"getContract\", // You'll need to create this servlet\n");
      out.write("                    type: \"GET\",\n");
      out.write("                    data: {\n");
      out.write("                        contractId: id\n");
      out.write("                    },\n");
      out.write("                    dataType: \"json\",\n");
      out.write("                    success: function (contract) {\n");
      out.write("                        if (contract) {\n");
      out.write("                            document.getElementById('contractId').value = contract.contractId;\n");
      out.write("                            document.getElementById('contractName').value = contract.contractName;\n");
      out.write("                            document.getElementById('contractType').value = contract.contractType;\n");
      out.write("                            document.getElementById('contractStatus').value = contract.status;\n");
      out.write("                            document.getElementById('fromEnterpriseId').value = contract.fromEnterpriseId;\n");
      out.write("                            document.getElementById('fromEnterpriseName').value = contract.fromEnterpriseName;\n");
      out.write("                            document.getElementById('toEnterpriseId').value = contract.toEnterpriseId;\n");
      out.write("                            document.getElementById('toEnterpriseName').value = contract.toEnterpriseName;\n");
      out.write("                            document.getElementById('amount').value = contract.amount;\n");
      out.write("\n");
      out.write("                            // Set dates if available\n");
      out.write("                            if (contract.signDate) {\n");
      out.write("                                document.getElementById('signDate').value = contract.signDate;\n");
      out.write("                            }\n");
      out.write("                            if (contract.effectiveDate) {\n");
      out.write("                                document.getElementById('effectiveDate').value = contract.effectiveDate;\n");
      out.write("                            }\n");
      out.write("                            if (contract.expiryDate) {\n");
      out.write("                                document.getElementById('expiryDate').value = contract.expiryDate;\n");
      out.write("                            }\n");
      out.write("\n");
      out.write("                            document.getElementById('paymentTerms').value = contract.paymentTerms || '';\n");
      out.write("                            document.getElementById('description').value = contract.description || '';\n");
      out.write("                            document.getElementById('remarks').value = contract.remarks || '';\n");
      out.write("                        } else {\n");
      out.write("                            alert('Contract not found');\n");
      out.write("                            window.location.href = 'contract.jsp';\n");
      out.write("                        }\n");
      out.write("                    },\n");
      out.write("                    error: function (xhr, status, error) {\n");
      out.write("                        alert(\"Error loading contract: \" + error);\n");
      out.write("                        window.location.href = 'contract.jsp';\n");
      out.write("                    }\n");
      out.write("                });\n");
      out.write("            }\n");
      out.write("        </script>\n");
      out.write("\n");
      out.write("        <!-- Enterprise Search Modal -->\n");
      out.write("        <div class=\"modal fade\" id=\"enterpriseSearchModal\" tabindex=\"-1\" role=\"dialog\"\n");
      out.write("            aria-labelledby=\"enterpriseSearchModalLabel\" aria-hidden=\"true\">\n");
      out.write("            <div class=\"modal-dialog modal-lg\" role=\"document\">\n");
      out.write("                <div class=\"modal-content\">\n");
      out.write("                    <div class=\"modal-header\">\n");
      out.write("                        <h5 class=\"modal-title\" id=\"enterpriseSearchModalLabel\">Search Enterprise</h5>\n");
      out.write("                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n");
      out.write("                            <span aria-hidden=\"true\">&times;</span>\n");
      out.write("                        </button>\n");
      out.write("                    </div>\n");
      out.write("                    <div class=\"modal-body\">\n");
      out.write("                        <!-- Search Form -->\n");
      out.write("                        <div class=\"form-row mb-3\">\n");
      out.write("                            <div class=\"form-group col-md-5\">\n");
      out.write("                                <label for=\"searchEnterpriseId\">Enterprise ID</label>\n");
      out.write("                                <input type=\"text\" class=\"form-control\" id=\"searchEnterpriseId\"\n");
      out.write("                                    placeholder=\"Enter Enterprise ID\">\n");
      out.write("                            </div>\n");
      out.write("                            <div class=\"form-group col-md-5\">\n");
      out.write("                                <label for=\"searchEnterpriseName\">Enterprise Name</label>\n");
      out.write("                                <input type=\"text\" class=\"form-control\" id=\"searchEnterpriseName\"\n");
      out.write("                                    placeholder=\"Enter Enterprise Name\">\n");
      out.write("                            </div>\n");
      out.write("                            <div class=\"form-group col-md-2 d-flex align-items-end\">\n");
      out.write("                                <button type=\"button\" class=\"btn btn-primary w-100\"\n");
      out.write("                                    onclick=\"searchEnterprises()\">Search</button>\n");
      out.write("                            </div>\n");
      out.write("                        </div>\n");
      out.write("\n");
      out.write("                        <!-- Search Results Table -->\n");
      out.write("                        <div class=\"table-responsive\">\n");
      out.write("                            <table class=\"table table-bordered table-hover\" id=\"enterpriseResultTable\">\n");
      out.write("                                <thead class=\"thead-light\">\n");
      out.write("                                    <tr>\n");
      out.write("                                        <th>ID</th>\n");
      out.write("                                        <th>Name</th>\n");
      out.write("                                        <th>Role</th>\n");
      out.write("                                        <th>Phone</th>\n");
      out.write("                                        <th>Address</th>\n");
      out.write("                                    </tr>\n");
      out.write("                                </thead>\n");
      out.write("                                <tbody id=\"enterpriseResultBody\">\n");
      out.write("                                    <!-- Results will be loaded here -->\n");
      out.write("                                </tbody>\n");
      out.write("                            </table>\n");
      out.write("                        </div>\n");
      out.write("                        <div id=\"enterpriseSearchMessage\" class=\"mt-2 text-center\">\n");
      out.write("                            Enter search criteria and click Search\n");
      out.write("                        </div>\n");
      out.write("                    </div>\n");
      out.write("                    <div class=\"modal-footer\">\n");
      out.write("                        <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Cancel</button>\n");
      out.write("                    </div>\n");
      out.write("                </div>\n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("\n");
      out.write("    </body>\n");
      out.write("\n");
      out.write("    </html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
